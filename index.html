<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ìœ¤ë‹˜ì„ ìœ„í•œ ì¼ë³¸ì–´ ë§ˆìŠ¤í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- í™ˆ í™”ë©´ ë°”ë¡œê°€ê¸° ë° ì•„ì´ì½˜ ì„¤ì • -->
    <link rel="icon" type="image/png" href="https://github.com/haboyo/diary-2/blob/main/image2.png?raw=true">
    <link rel="apple-touch-icon" href="https://github.com/haboyo/diary-2/blob/main/image2.png?raw=true">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ì§€ìœ¤ ì¼ì–´">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&family=Noto+Sans+JP:wght@700&family=Nanum+Pen+Script&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        .jp-font { font-family: 'Noto Sans JP', sans-serif; }
        .handwriting { font-family: 'Nanum+Pen+Script', cursive; }
        .text-giant { font-size: 6.5rem; }
        .character-card { transition: all 0.15s ease; }
        .character-card:active { transform: scale(0.92); background-color: #f0f7ff; }
        .sticky-nav { position: sticky; top: 0; z-index: 40; background: white; }
        
        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 30px;
            border-width: 15px 15px 0 0;
            border-style: solid;
            border-color: white transparent transparent transparent;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce-slow { animation: bounce 3s infinite; }
    </style>
</head>
<body class="min-h-screen pb-10">
    <div id="app" class="max-w-3xl mx-auto bg-white min-h-screen shadow-2xl flex flex-col">
        
        <!-- ìƒë‹¨ í—¤ë” -->
        <div class="bg-gradient-to-b from-indigo-500 to-indigo-600 p-6 pt-10 relative overflow-hidden">
            <div class="relative z-10 flex flex-col items-start gap-4">
                <div class="speech-bubble bg-white text-indigo-900 p-5 rounded-[2rem] shadow-xl relative mb-4 animate-bounce-slow">
                    <p class="text-2xl font-black handwriting tracking-wide">
                        "ì§€ìœ¤ì•„ ë„Œ í•  ìˆ˜ ìˆì–´!! ì‘ì›í• ê²Œ!! âœ¨"
                    </p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="w-24 h-24 rounded-full border-4 border-white overflow-hidden shadow-2xl bg-white">
                        <img src="https://github.com/haboyo/diary-2/blob/main/image.png?raw=true" alt="ì§€ìœ¤ë‹˜ ì•„ì´ì½˜" class="w-full h-full object-cover" onerror="this.src='https://api.dicebear.com/7.x/avataaars/svg?seed=Felix'">
                    </div>
                    <div class="text-white">
                        <h1 class="text-2xl font-black leading-none mb-1">ì§€ìœ¤ë‹˜ ì „ìš© í•™ìŠµê¸°</h1>
                        <p class="text-indigo-200 text-sm font-bold opacity-80 uppercase tracking-widest">7 Days Challenge</p>
                    </div>
                </div>
            </div>
            <div class="absolute -right-10 -bottom-10 w-40 h-40 bg-white opacity-10 rounded-full"></div>
        </div>

        <!-- íƒ­ ë©”ë‰´ -->
        <nav class="flex sticky-nav shadow-md border-b">
            <button onclick="switchTab('plan')" id="tab-plan" class="flex-1 py-5 text-xl font-bold text-indigo-600 border-b-4 border-indigo-600">í•™ìŠµ í”Œëœ</button>
            <button onclick="switchTab('study')" id="tab-study" class="flex-1 py-5 text-xl font-bold text-gray-400 border-b-4 border-transparent">í•™ìŠµí•˜ê¸°</button>
            <button onclick="switchTab('quiz')" id="tab-quiz" class="flex-1 py-5 text-xl font-bold text-gray-400 border-b-4 border-transparent">í€´ì¦ˆ</button>
        </nav>

        <!-- í”Œëœ ë¦¬ìŠ¤íŠ¸ -->
        <main id="content-plan" class="p-6 space-y-4">
            <div class="flex items-center justify-between mb-2">
                <h2 class="text-2xl font-black text-slate-800">ğŸ—“ï¸ 7ì¼ ë¡œë“œë§µ</h2>
                <span class="text-indigo-500 font-bold bg-indigo-50 px-3 py-1 rounded-lg text-sm italic">Fighting!</span>
            </div>
            <div id="plan-list" class="space-y-4">
                <!-- Day 1-7 (ìƒëµ ì—†ì´ ìœ ì§€) -->
                <script>
                    const days = [
                        { d: 1, t: 'íˆë¼ê°€ë‚˜ (ã‚/ã‹í–‰)', s: 'ê¸°ë³¸ì˜ ì‹œì‘, 10ì ì •ë³µ', c: 'indigo' },
                        { d: 2, t: 'íˆë¼ê°€ë‚˜ (ã•/ãŸí–‰)', s: 'ìµìˆ™í•´ì§€ëŠ” ë‹¨ê³„, 10ì', c: 'blue' },
                        { d: 3, t: 'íˆë¼ê°€ë‚˜ (ë‚˜/í•˜í–‰)', s: 'ëª¨ì–‘ì´ ë³µì¡í•´ì§€ëŠ” êµ¬ê°„, 10ì', c: 'cyan' },
                        { d: 4, t: 'íˆë¼ê°€ë‚˜ ë§ˆë¬´ë¦¬', s: 'ë§ˆì§€ë§‰ 16ì ëª°ì•„ì¹˜ê¸°', c: 'teal' },
                        { d: 5, t: 'ê°€íƒ€ì¹´ë‚˜ ì§‘ì¤‘ (1)', s: 'ë‹¨ì–´ ì™¸ë˜ì–´ ì¤€ë¹„, 20ì', c: 'amber' },
                        { d: 6, t: 'ê°€íƒ€ì¹´ë‚˜ ì§‘ì¤‘ (2)', s: 'ë§ˆì§€ë§‰ ì¡°ê° ë§ì¶”ê¸°, 26ì', c: 'orange' }
                    ];
                    days.forEach(day => {
                        document.write(`
                            <div onclick="goToDay(${day.d})" class="group p-6 border-2 border-slate-100 rounded-[2rem] cursor-pointer hover:border-indigo-400 hover:bg-indigo-50/30 transition flex items-center justify-between bg-white shadow-sm">
                                <div class="flex items-center gap-5">
                                    <div class="w-14 h-14 bg-${day.c}-100 rounded-2xl flex items-center justify-center text-${day.c}-600 font-black text-xl">${day.d}</div>
                                    <div>
                                        <h3 class="text-xl font-bold text-slate-800">${day.t}</h3>
                                        <p class="text-slate-400 font-medium">${day.s}</p>
                                    </div>
                                </div>
                                <i class="fas fa-arrow-right text-${day.c}-300 group-hover:translate-x-1 transition"></i>
                            </div>
                        `);
                    });
                </script>
                <div onclick="goToDay(7)" class="p-6 bg-indigo-900 rounded-[2rem] cursor-pointer transition flex items-center justify-between shadow-2xl text-white hover:scale-[1.02]">
                    <div class="flex items-center gap-5">
                        <div class="w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center text-yellow-400 font-black text-2xl animate-pulse"><i class="fas fa-star"></i></div>
                        <div>
                            <h3 class="text-xl font-bold">ìµœì¢… ë§ˆìŠ¤í„° ì±Œë¦°ì§€</h3>
                            <p class="text-indigo-200 font-medium text-sm">ëª¨ë“  ë¬¸ì í€´ì¦ˆ ì •ë³µí•˜ê¸°</p>
                        </div>
                    </div>
                    <i class="fas fa-trophy text-yellow-500 text-2xl"></i>
                </div>
            </div>
        </main>

        <!-- í•™ìŠµí•˜ê¸° ì„¹ì…˜ -->
        <main id="content-study" class="flex-1 p-4 hidden">
            <div class="sticky top-[80px] bg-white py-4 z-20 border-b mb-6">
                <div class="flex items-center justify-between mb-4 px-2">
                    <h2 id="study-title" class="text-2xl font-black text-indigo-600 italic">Day 1 í•™ìŠµ</h2>
                    <button onclick="resetFilter()" class="text-sm font-bold text-slate-400 hover:text-indigo-500 transition">
                        <i class="fas fa-redo-alt mr-1"></i>ì „ì²´ ë³´ê¸°
                    </button>
                </div>
                <div class="flex gap-3">
                    <button onclick="setCharType('hira')" id="btn-hira" class="flex-1 py-3 rounded-2xl bg-indigo-600 text-white text-lg font-bold shadow-md">íˆë¼ê°€ë‚˜</button>
                    <button onclick="setCharType('kata')" id="btn-kata" class="flex-1 py-3 rounded-2xl bg-gray-100 text-gray-500 text-lg font-bold">ê°€íƒ€ì¹´ë‚˜</button>
                </div>
            </div>
            <div id="char-list" class="space-y-10"></div>
        </main>

        <!-- í€´ì¦ˆ ì„¹ì…˜ -->
        <main id="content-quiz" class="flex-1 p-6 hidden flex flex-col items-center">
            <div id="quiz-container" class="w-full max-w-md">
                <div class="flex justify-between items-center mb-6">
                    <span class="bg-indigo-50 px-5 py-2 rounded-full border border-indigo-100 font-bold text-indigo-600">ì„±ê³µ: <span id="score">0</span></span>
                    <span id="quiz-progress" class="bg-gray-50 px-5 py-2 rounded-full border border-gray-100 font-bold text-slate-500">1 / 10</span>
                </div>
                <div class="bg-white border-4 border-indigo-50 rounded-[3rem] p-12 mb-8 text-center shadow-2xl relative overflow-hidden">
                    <div id="quiz-question" class="jp-font text-giant font-bold text-indigo-900 leading-none relative z-10">ã‚</div>
                </div>
                <div id="quiz-options" class="grid grid-cols-2 gap-4"></div>
            </div>
            <div id="quiz-result" class="hidden text-center py-20 w-full">
                <div class="text-[10rem] mb-8 leading-none">ğŸ–ï¸</div>
                <h2 class="text-4xl font-black text-slate-800 mb-2">ëŒ€ë‹¨í•´ìš” ì§€ìœ¤ë‹˜!</h2>
                <button onclick="startQuiz()" class="w-full max-w-sm bg-indigo-600 text-white py-6 rounded-[2rem] text-2xl font-bold shadow-xl active:scale-95 transition">ë‹¤ì‹œ ë„ì „</button>
            </div>
        </main>

        <!-- ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
        <div id="detail-modal" class="fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center p-6 z-50 hidden" onclick="closeModal()">
            <div class="bg-white rounded-[3rem] p-10 max-w-md w-full text-center relative shadow-2xl" onclick="event.stopPropagation()">
                <button onclick="closeModal()" class="absolute top-6 right-8 text-gray-300 text-4xl hover:text-indigo-400 transition"><i class="fas fa-times"></i></button>
                <div id="modal-char" class="jp-font text-giant font-bold text-indigo-600 mb-2 leading-none">ã‚</div>
                <div id="modal-reading" class="text-4xl font-black text-slate-800 mb-8">a (ì•„)</div>
                <div class="bg-indigo-50 rounded-[2.5rem] p-8 mb-10 border-2 border-dashed border-indigo-100 relative">
                    <div id="modal-mnemonic-img" class="text-7xl mb-4">ğŸ¨</div>
                    <p id="modal-mnemonic" class="text-2xl text-slate-700 font-medium leading-relaxed">ì„¤ëª…</p>
                </div>
                <button onclick="playAudio()" class="w-full py-6 bg-indigo-600 rounded-[2rem] text-white text-2xl font-bold flex items-center justify-center gap-4 shadow-xl active:scale-95 transition">
                    <i class="fas fa-volume-up"></i><span>ì²œì²œíˆ ë°œìŒ ë“£ê¸°</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        const fullDataset = [
            { dayId: 1, row: 'ã‚ (ì•„)í–‰', items: [
                { hira: 'ã‚', kata: 'ã‚¢', romaji: 'a', ko: 'ì•„', mnemonic: 'ë‚šì‹œë°”ëŠ˜ì— ê±¸ë¦° "ì•„"ê¸° ë¬¼ê³ ê¸°', icon: 'ğŸŸ' },
                { hira: 'ã„', kata: 'ã‚¤', romaji: 'i', ko: 'ì´', mnemonic: 'ê¸¸ì­‰í•œ "ì´"ë¹¨ ë‘ ê°œ', icon: 'ğŸ¦·' },
                { hira: 'ã†', kata: 'ã‚¦', romaji: 'u', ko: 'ìš°', mnemonic: 'ì˜†ìœ¼ë¡œ ëˆ„ìš´ "ìš°"ì‚° ëª¨ì–‘', icon: 'â˜‚ï¸' },
                { hira: 'ãˆ', kata: 'ã‚¨', romaji: 'e', ko: 'ì—', mnemonic: '"ì—"ë„ˆì œí‹±í•˜ê²Œ ë‹¬ë¦¬ëŠ” ì‚¬ëŒ', icon: 'ğŸƒ' },
                { hira: 'ãŠ', kata: 'ã‚ª', romaji: 'o', ko: 'ì˜¤', mnemonic: '"ì˜¤"ë¦¬ ì£¼ë‘¥ì´ì™€ ëª¸í†µ', icon: 'ğŸ¦†' }
            ]},
            { dayId: 1, row: 'ã‹ (ì¹´)í–‰', items: [
                { hira: 'ã‹', kata: 'ã‚«', romaji: 'ka', ko: 'ì¹´', mnemonic: '"ì¹´"ë©”ë¼ ì…”í„°ë¥¼ ì°°ì¹µ!', icon: 'ğŸ“·' },
                { hira: 'ã', kata: 'ã‚­', romaji: 'ki', ko: 'í‚¤', mnemonic: '"í‚¤"(ì—´ì‡ ) êµ¬ë© ëª¨ì–‘', icon: 'ğŸ”‘' },
                { hira: 'ã', kata: 'ã‚¯', romaji: 'ku', ko: 'ì¿ ', mnemonic: '"ì¿ "í‚¤ ë¨¹ìœ¼ë ¤ ë²Œë¦° ì…', icon: 'ğŸª' },
                { hira: 'ã‘', kata: 'ã‚±', romaji: 'ke', ko: 'ì¼€', mnemonic: '"ì¼€"ì´í¬ ìë¥´ëŠ” ë‚˜ì´í”„', icon: 'ğŸ°' },
                { hira: 'ã“', kata: 'ã‚³', romaji: 'ko', ko: 'ì½”', mnemonic: '"ì½”"ë¼ë¦¬ì˜ ìƒì•„ ëª¨ìŠµ', icon: 'ğŸ˜' }
            ]},
            { dayId: 2, row: 'ã• (ì‚¬)í–‰', items: [
                { hira: 'ã•', kata: 'ã‚µ', romaji: 'sa', ko: 'ì‚¬', mnemonic: '"ì‚¬"ê³¼ ì†ì˜ ì”¨ì•— ë‘ ê°œ', icon: 'ğŸ' },
                { hira: 'ã—', kata: 'ã‚·', romaji: 'shi', ko: 'ì‹œ', mnemonic: '"ì‹œ"ì›í•œ ë‚šì‹œë°”ëŠ˜', icon: 'ğŸ£' },
                { hira: 'ã™', kata: 'ã‚¹', romaji: 'su', ko: 'ìŠ¤', mnemonic: '"ìŠ¤"í”„ë§ì²˜ëŸ¼ ê¼¬ì¸ ê¼¬ë¦¬', icon: 'ğŸŒ€' },
                { hira: 'ã›', kata: 'ã‚»', romaji: 'se', ko: 'ì„¸', mnemonic: '"ì„¸"ìƒ ë°–ìœ¼ë¡œ ë»—ì€ ì†', icon: 'ğŸ–ï¸' },
                { hira: 'ã', kata: 'ã‚½', romaji: 'so', ko: 'ì†Œ', mnemonic: '"ì†Œ"ìš©ëŒì´ì¹˜ëŠ” ë¬¼ê²°', icon: 'ğŸŒªï¸' }
            ]},
            { dayId: 2, row: 'ãŸ (íƒ€)í–‰', items: [
                { hira: 'ãŸ', kata: 'ã‚¿', romaji: 'ta', ko: 'íƒ€', mnemonic: '"íƒ€"ì ì¹˜ëŠ” ì†ê°€ë½', icon: 'âŒ¨ï¸' },
                { hira: 'ì¹˜', kata: 'ãƒ', romaji: 'chi', ko: 'ì¹˜', mnemonic: '"ì¹˜"ì¦ˆ ì¡°ê°ê³¼ í¬í¬', icon: 'ğŸ§€' },
                { hira: 'ã¤', kata: 'ãƒ„', romaji: 'tsu', ko: 'ì¸ ', mnemonic: '"ì¸ "ë‚˜ë¯¸(íŒŒë„)ê°€ ëª°ì•„ì³ìš”', icon: 'ğŸŒŠ' },
                { hira: 'ã¦', kata: 'ãƒ†', romaji: 'te', ko: 'í…Œ', mnemonic: '"í…Œ"ì´ë¸”ì˜ ë‹¤ë¦¬ ëª¨ì–‘', icon: 'ğŸª‘' },
                { hira: 'ã¨', kata: 'ãƒˆ', romaji: 'to', ko: 'í† ', mnemonic: '"í† "ë¼ì˜ ì«‘ê¸‹í•œ ê·€', icon: 'ğŸ°' }
            ]},
            { dayId: 3, row: 'ë‚˜ (ë‚˜)í–‰', items: [
                { hira: 'ãª', kata: 'ë‚˜', romaji: 'na', ko: 'ë‚˜', mnemonic: '"ë‚˜"ë¹„ì˜ ë‚ ê°œì§“', icon: 'ğŸ¦‹' },
                { hira: 'ã«', kata: 'ë‹ˆ', romaji: 'ni', ko: 'ë‹ˆ', mnemonic: '"ë‹ˆ"íŠ¸ ì§œëŠ” ë°”ëŠ˜ ë‘ ê°œ', icon: 'ğŸ§¶' },
                { hira: 'ã¬', kata: 'ëˆ„', romaji: 'nu', ko: 'ëˆ„', mnemonic: '"ëˆ„"ì—ê³ ì¹˜ê°€ ê¼¬ì˜€ë„¤', icon: 'ğŸ›' },
                { hira: 'ë„¤', kata: 'ë„¤', romaji: 'ne', ko: 'ë„¤', mnemonic: '"ë„¤"ì½”(ê³ ì–‘ì´)ì˜ ê¼¬ë¦¬', icon: 'ğŸ±' },
                { hira: 'ã®', kata: 'ë…¸', romaji: 'no', ko: 'ë…¸', mnemonic: '"ë…¸"(No)ë¼ê³  í•˜ëŠ” ê¸ˆì§€í‘œì‹œ', icon: 'ğŸš«' }
            ]},
            { dayId: 3, row: 'í•˜ (í•˜)í–‰', items: [
                { hira: 'ã¯', kata: 'í•˜', romaji: 'ha', ko: 'í•˜', mnemonic: '"í•˜"í”„ë¥¼ ì—°ì£¼í•´ìš”', icon: 'ğŸµ' },
                { hira: 'ã²', kata: 'íˆ', romaji: 'hi', ko: 'íˆ', mnemonic: '"íˆ"ì£½ ì›ƒëŠ” ì… ëª¨ì–‘', icon: 'ğŸ˜Š' },
                { hira: 'ãµ', kata: 'í›„', romaji: 'fu', ko: 'í›„', mnemonic: '"í›„"í›„ ë¶ˆê³  ìˆëŠ” ì…', icon: 'ğŸ˜—' },
                { hira: 'ã¸', kata: 'í—¤', romaji: 'he', ko: 'í—¤', mnemonic: '"í—¤"ë“œ(ë¨¸ë¦¬) ìœ„ ì‚°ëª¨ì–‘', icon: 'â›°ï¸' },
                { hira: 'ã»', kata: 'í˜¸', romaji: 'ho', ko: 'í˜¸', mnemonic: '"í˜¸"ë‘ ê»ì§ˆì´ ë²Œì–´ì§', icon: 'ğŸ¥¥' }
            ]},
            { dayId: 4, row: 'ë§ˆë¬´ë¦¬í–‰ (1/2)', items: [
                { hira: 'ã¾', kata: 'ë§ˆ', romaji: 'ma', ko: 'ë§ˆ', mnemonic: '"ë§ˆ"ë²•ì‚¬ì˜ ì§€íŒ¡ì´', icon: 'ğŸª„' },
                { hira: 'ã¿', kata: 'ë¯¸', romaji: 'mi', ko: 'ë¯¸', mnemonic: '"ë¯¸"ë¡œì²˜ëŸ¼ ê¼¬ì¸ ê¸¸', icon: 'ğŸŒ€' },
                { hira: 'ã‚€', kata: 'ë¬´', romaji: 'mu', ko: 'ë¬´', mnemonic: '"ë¬´"ê±°ìš´ ì§ì„ ë“  ì†Œ', icon: 'ğŸ‚' },
                { hira: 'ã‚', kata: 'ë©”', romaji: 'me', ko: 'ë©”', mnemonic: '"ë©”"ì¶”ë¦¬ ì•Œì„ ë‹®ì€ ëˆˆ', icon: 'ğŸ‘ï¸' },
                { hira: 'ã‚‚', kata: 'ëª¨', romaji: 'mo', ko: 'ëª¨', mnemonic: '"ëª¨"ë‚´ê¸° í•  ë•Œ ì“°ëŠ” ê°ˆê³ ë¦¬', icon: 'â›ï¸' }
            ]},
            { dayId: 4, row: 'ë§ˆë¬´ë¦¬í–‰ (2/2)', items: [
                { hira: 'ã‚„', kata: 'ì•¼', romaji: 'ya', ko: 'ì•¼', mnemonic: '"ì•¼"êµ¬ ë°©ë§ì´ì™€ ê³µ', icon: 'âš¾' },
                { hira: 'ã‚†', kata: 'ìœ ', romaji: 'yu', ko: 'ìœ ', mnemonic: '"ìœ "ì„ í˜• ë¬¼ê³ ê¸° ëª¸í†µ', icon: 'ğŸŸ' },
                { hira: 'ã‚ˆ', kata: 'ìš”', romaji: 'yo', ko: 'ìš”', mnemonic: '"ìš”"ìš”ê°€ ë§¤ë‹¬ë¦° ëª¨ì–‘', icon: 'ğŸª€' },
                { hira: 'ã‚‰', kata: 'ë¼', romaji: 'ra', ko: 'ë¼', mnemonic: '"ë¼"ë””ì˜¤ ì•ˆí…Œë‚˜ ì„¸ì›€', icon: 'ğŸ“»' },
                { hira: 'ã‚Š', kata: 'ë¦¬', romaji: 'ri', ko: 'ë¦¬', mnemonic: '"ë¦¬"ë³¸ ë‘ ê°€ë‹¥', icon: 'ğŸ€' },
                { hira: 'ã‚‹', kata: 'ë£¨', romaji: 'ru', ko: 'ë£¨', mnemonic: '"ë£¨"í”„(ê³ ë¦¬)ê°€ ìˆëŠ” ê¸¸', icon: 'â°' },
                { hira: 'ã‚Œ', kata: 'ë ˆ', romaji: 're', ko: 'ë ˆ', mnemonic: '"ë ˆ"ìŠ¬ë§ ì„ ìˆ˜ì˜ ë“±', icon: 'ğŸ¤¼' },
                { hira: 'ã‚', kata: 'ë¡œ', romaji: 'ro', ko: 'ë¡œ', mnemonic: '"ë¡œ"ì¼“ì´ ì§€ë‚˜ê°„ ê¼¬ë¦¬', icon: 'ğŸš€' },
                { hira: 'ã‚', kata: 'ì™€', romaji: 'wa', ko: 'ì™€', mnemonic: '"ì™€"ì¸ ì”ì˜ ê³¡ì„ ', icon: 'ğŸ·' },
                { hira: 'ã‚’', kata: 'ì˜¤', romaji: 'wo', ko: 'ì˜¤', mnemonic: '"ì˜¤"ìƒ‰ì°¬ë€í•œ ì›ë°˜', icon: 'ğŸ’¿' },
                { hira: 'ã‚“', kata: 'ì‘', romaji: 'n', ko: 'ì‘', mnemonic: '"ì‘"í•˜ê³  ëŒ€ë‹µí•˜ëŠ” ì…', icon: 'ğŸ’¬' }
            ]}
        ];

        let currentType = 'hira';
        let currentDayFilter = null;
        let quizState = { score: 0, index: 0, correctAnswer: null };

        function switchTab(tab) {
            ['plan', 'study', 'quiz'].forEach(t => {
                document.getElementById(`content-${t}`).classList.toggle('hidden', t !== tab);
                const btn = document.getElementById(`tab-${t}`);
                if (btn) btn.className = t === tab ? 'flex-1 py-5 text-xl font-bold text-indigo-600 border-b-4 border-indigo-600' : 'flex-1 py-5 text-xl font-bold text-gray-400 border-b-4 border-transparent';
            });
            if (tab === 'quiz') startQuiz();
            window.scrollTo(0, 0);
        }

        function goToDay(day) {
            currentDayFilter = day;
            if (day === 7) { switchTab('quiz'); return; }
            setCharType(day >= 5 ? 'kata' : 'hira');
            document.getElementById('study-title').innerText = `DAY ${day} ì§‘ì¤‘ í•™ìŠµ`;
            switchTab('study');
            renderStudyList();
        }

        function resetFilter() {
            currentDayFilter = null;
            document.getElementById('study-title').innerText = `ì „ì²´ ë¬¸ì ë³´ê¸°`;
            renderStudyList();
        }

        function setCharType(type) {
            currentType = type;
            document.getElementById('btn-hira').className = type === 'hira' ? 'flex-1 py-3 rounded-2xl bg-indigo-600 text-white text-lg font-bold shadow-md' : 'flex-1 py-3 rounded-2xl bg-gray-100 text-gray-500 text-lg font-bold';
            document.getElementById('btn-kata').className = type === 'kata' ? 'flex-1 py-3 rounded-2xl bg-indigo-600 text-white text-lg font-bold shadow-md' : 'flex-1 py-3 rounded-2xl bg-gray-100 text-gray-500 text-lg font-bold';
            renderStudyList();
        }

        function renderStudyList() {
            const list = document.getElementById('char-list');
            list.innerHTML = '';
            let filteredData = fullDataset;
            if (currentDayFilter) {
                if (currentDayFilter <= 4) filteredData = fullDataset.filter(g => g.dayId === currentDayFilter);
                else {
                    const kataDays = {
                        5: ['ã‚í–‰', 'ã‹í–‰', 'ã•í–‰', 'ãŸí–‰'],
                        6: ['ë‚˜í–‰', 'í•˜í–‰', 'ë§ˆë¬´ë¦¬í–‰ (1/2)', 'ë§ˆë¬´ë¦¬í–‰ (2/2)']
                    };
                    filteredData = fullDataset.filter(g => kataDays[currentDayFilter].some(name => g.row.includes(name)));
                }
            }
            filteredData.forEach(group => {
                const section = document.createElement('div');
                section.innerHTML = `<h3 class="text-xl font-black text-slate-300 mb-4 px-2 italic uppercase border-l-4 border-indigo-100 pl-4">${group.row}</h3>`;
                const grid = document.createElement('div');
                grid.className = 'grid grid-cols-5 gap-3';
                group.items.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'character-card bg-white border-2 border-slate-50 rounded-[1.5rem] py-6 text-center shadow-sm cursor-pointer';
                    card.onclick = () => showDetail(item);
                    card.innerHTML = `<div class="jp-font text-5xl font-bold text-slate-800 leading-none mb-1">${item[currentType]}</div><div class="text-xs text-indigo-400 font-black uppercase">${item.romaji}</div>`;
                    grid.appendChild(card);
                });
                section.appendChild(grid);
                list.appendChild(section);
            });
        }

        function showDetail(item) {
            document.getElementById('modal-char').innerText = item[currentType];
            document.getElementById('modal-reading').innerText = `${item.romaji} (${item.ko})`;
            document.getElementById('modal-mnemonic').innerText = item.mnemonic;
            document.getElementById('modal-mnemonic-img').innerText = item.icon;
            document.getElementById('detail-modal').classList.remove('hidden');
        }

        function closeModal() { document.getElementById('detail-modal').classList.add('hidden'); }

        /**
         * ì§€ìœ¤ë‹˜ì„ ìœ„í•œ ì´ˆì €ì† ë°œìŒ ì¬ìƒ (0.4)
         */
        function playAudio() {
            window.speechSynthesis.cancel(); 
            const msg = new SpeechSynthesisUtterance(document.getElementById('modal-char').innerText);
            msg.lang = 'ja-JP'; 
            msg.rate = 0.4;  // ì•„ì£¼ ì²œì²œíˆ (ê¸°ë³¸ 1.0)
            msg.pitch = 0.9; // í†¤ì„ ì•½ê°„ ë‚®ì¶°ì„œ ë” ì°¨ë¶„í•˜ê²Œ
            window.speechSynthesis.speak(msg);
        }

        function startQuiz() {
            quizState.score = 0; quizState.index = 0;
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('quiz-result').classList.add('hidden');
            nextQuestion();
        }

        function nextQuestion() {
            if (quizState.index >= 10) { showResult(); return; }
            const allItems = fullDataset.flatMap(g => g.items);
            const correctItem = allItems[Math.floor(Math.random() * allItems.length)];
            quizState.correctAnswer = correctItem.ko;
            document.getElementById('quiz-question').innerText = correctItem[Math.random() > 0.5 ? 'hira' : 'kata'];
            document.getElementById('quiz-progress').innerText = `${quizState.index + 1} / 10`;
            document.getElementById('score').innerText = quizState.score;

            let options = [correctItem.ko];
            while (options.length < 4) {
                const rKo = allItems[Math.floor(Math.random() * allItems.length)].ko;
                if (!options.includes(rKo)) options.push(rKo);
            }
            options.sort(() => Math.random() - 0.5);
            const container = document.getElementById('quiz-options');
            container.innerHTML = '';
            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'py-6 bg-white border-2 border-slate-100 rounded-3xl text-2xl font-bold text-slate-700 active:scale-95 transition shadow-sm';
                btn.innerText = opt;
                btn.onclick = () => {
                    const isCorrect = opt === quizState.correctAnswer;
                    if (isCorrect) quizState.score++;
                    showFeedback(isCorrect);
                    setTimeout(() => { quizState.index++; nextQuestion(); }, 600);
                };
                container.appendChild(btn);
            });
        }

        function showFeedback(isCorrect) {
            const f = document.createElement('div');
            f.className = 'fixed inset-0 flex items-center justify-center z-[100] pointer-events-none';
            f.innerHTML = `<div class="text-[12rem] animate-ping">${isCorrect ? 'â­•' : 'âŒ'}</div>`;
            document.body.appendChild(f); setTimeout(() => f.remove(), 600);
        }

        function showResult() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('quiz-result').classList.remove('hidden');
        }

        renderStudyList();
    </script>
</body>
</html>

